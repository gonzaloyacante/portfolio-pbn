// Prisma Schema para Portfolio PBN v2
// PostgreSQL como base de datos principal

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// USUARIOS Y AUTENTICACIÓN
// ============================================

enum Role {
  ADMIN
  VIEWER
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String   // Hasheado con bcrypt
  name      String
  role      Role     @default(ADMIN)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email])
  @@map("users")
}

// ============================================
// PROYECTOS Y CATEGORÍAS
// ============================================

model ProjectCategory {
  id          String    @id @default(uuid())
  slug        String    @unique
  name        String
  description String?
  order       Int       @default(0)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  projects    Project[]

  @@index([slug])
  @@index([order])
  @@map("project_categories")
}

enum ProjectStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

model Project {
  id               String         @id @default(uuid())
  slug             String         @unique
  title            String
  description      String         @db.Text
  shortDescription String
  thumbnailUrl     String
  featured         Boolean        @default(false)
  order            Int            @default(0)
  status           ProjectStatus  @default(DRAFT)
  categoryId       String
  category         ProjectCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  images           ProjectImage[]
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt

  @@index([slug])
  @@index([categoryId])
  @@index([featured])
  @@index([status])
  @@index([order])
  @@map("projects")
}

model ProjectImage {
  id        String   @id @default(uuid())
  url       String
  alt       String
  order     Int      @default(0)
  projectId String
  project   Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())

  @@index([projectId])
  @@index([order])
  @@map("project_images")
}

// ============================================
// CONTACTOS
// ============================================

enum ContactStatus {
  NEW
  READ
  RESPONDED
  ARCHIVED
}

model Contact {
  id          String        @id @default(uuid())
  name        String
  email       String
  phone       String?
  subject     String
  message     String        @db.Text
  status      ContactStatus @default(NEW)
  response    String?       @db.Text
  respondedAt DateTime?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  @@index([status])
  @@index([createdAt])
  @@map("contacts")
}

// ============================================
// HABILIDADES Y REDES SOCIALES
// ============================================

model Skill {
  id          String   @id @default(uuid())
  name        String
  description String?
  level       Int      @default(50) // 0-100 percentage
  icon        String?
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([order])
  @@map("skills")
}

enum SocialPlatform {
  FACEBOOK
  INSTAGRAM
  TWITTER
  LINKEDIN
  YOUTUBE
  TIKTOK
  WHATSAPP
  EMAIL
  BEHANCE
  OTHER
}

model SocialLink {
  id        String         @id @default(uuid())
  platform  SocialPlatform
  url       String
  label     String?
  icon      String?
  order     Int            @default(0)
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt

  @@index([order])
  @@map("social_links")
}

// ============================================
// CONFIGURACIÓN GLOBAL DEL PORTFOLIO (SINGLETON)
// ============================================

model PortfolioSettings {
  id                 String   @id @default("singleton")
  siteName           String
  siteDescription    String   @db.Text
  siteUrl            String
  ownerName          String
  ownerTitle         String
  ownerBio           String   @db.Text
  ownerEmail         String
  ownerPhone         String?
  ownerLocation      String?
  logoUrl            String?
  faviconUrl         String?
  ogImageUrl         String?
  metaKeywords       String?
  googleAnalyticsId  String?
  facebookPixelId    String?
  maintenanceMode    Boolean  @default(false)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@map("portfolio_settings")
}
